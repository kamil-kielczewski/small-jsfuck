<!doctype html>
<html>
  <head>
    <title>Small JSFuck</title>
    <style>pre {white-space: pre-wrap;} textarea{ margin-top: 20px; width: 100%; height: 200px}</style>
    <script src="small-jsfuck.js"></script>
  </head>
  <body>
    <div>GitHub project with explanation <a href="https://github.com/kamil-kielczewski/small-jsfuck">here</a></div>
    <h1>Create small JSFuck code</h1>
    <div>Compiler tested (31.08.2020) on Chrome 84, Firefox 79, Safari 13 and <a href="https://repl.it/languages/nodejs">node.js 12.16.1</a></div>
    <div>1 kB of input code gives 16-32kb (usually ~24kb) output plus ~23kb bootstrap code</div>
    <small>Example from <a href="https://codegolf.stackexchange.com/a/193900/88163">here</a> 
        (31.08.2020: <a href="jsfuck.com">jsfuck.com</a> produce: 247545 chars, 
         <a href="https://syllab.fr/projets/experiments/xcharsjs/6chars.html">Xchars.js</a> produce 72658 chars) 
    </small>
    <div><textarea id="code">c=512;for(p=i='';j=x=y=0,++i<=c*c;p+=9*c+9*j)while(x*x+y*y<4&&++j-c)[x,y]=[x*x-y*y+i%c/128-2,2*x*y+i/c/128-2];document.write("<img src=data:;base64,Qk0bAAwAAAAAABsAAAAMAAAAAAIAAgEAGAAA"+p+">")</textarea></div>
    <button onclick=convert()>convert to executable</button>
    <button onclick=convertToText()>convert to string</button>    
    <button onclick=run()>run</button>
    <div id="jsfLength"></div>
    <textarea id="jsfCode"></textarea>
    <script>

function convert() {
  let overhead = 23423;
  let src = code.value;
  let result = compileToSmallJSFuck(src)
  jsfCode.value = result;
  jsfLength.innerText=` Source length: ${src.length}, covnerted-jsf-code length: ${result.length - overhead}, overhead: ${overhead}, total: ${result.length}`
}
      
function convertToText() {
  let overhead = 23423-595;
  let src = code.value;
  let result = compileToSmallJSFuck(src,true)
  jsfCode.value = result;
  jsfLength.innerText=` Source length: ${src.length}, covnerted-jsf-code length: ${result.length - overhead}, overhead: ${overhead}, total: ${result.length}`
}

function run() {
    let src = code.value;
    let result = compileToSmallJSFuck(src)
    eval(result);
}

    </script>
  </body>
</html>
